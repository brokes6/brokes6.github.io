<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">

  

  

  
    <meta name="author" content="Fuxinbo">
  

  

  

  <title>ä¾èµ–æ³¨å…¥ | Fuxinboåšå®¢</title>

  

  
    <link rel="icon" href="/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://qiniu.miiiku.xyz/src/images/banner.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          Fuxinboåšå®¢
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">HOME</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text">
        <div class="type-wrap">
          
        </div>
        <h1 class="title-wrap">ä¾èµ–æ³¨å…¥</h1>
        <h2 class="title-sub-wrap">
          <strong>Fuxinbo</strong>
          <span>å‘å¸ƒäº</span>
          
  <a href="javascript:;" class="article-date">
    <time datetime="2020-09-21T14:14:00.000Z" itemprop="datePublished">2020-09-21</time>
  </a>

        </h2>
      </div>
    </div>
  

  
  
  
</header>

    <!-- æ–‡ç«  -->

<!-- æ–‡ç« å†…å®¹ -->

<div class="body-container">
  <article class="content-container article-container">
    <div class="article-content">
      
      

      <section class="article-entry">
        <h1 id="ä¾èµ–æ³¨å…¥"><a href="#ä¾èµ–æ³¨å…¥" class="headerlink" title="ä¾èµ–æ³¨å…¥"></a>ä¾èµ–æ³¨å…¥</h1><h6 id="åŸç†ï¼š"><a href="#åŸç†ï¼š" class="headerlink" title="åŸç†ï¼š"></a>åŸç†ï¼š</h6><p>ä¾èµ–æ³¨å…¥æ˜¯å®ç°ç¨‹åºè§£è€¦çš„ä¸€ç§æ–¹å¼ã€‚å¦‚æœé€šè¿‡ç™¾åº¦æœç´¢å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ç­”æ¡ˆï¼š<br>æ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼Œè‹±æ–‡ç¼©å†™ä¸ºIoCï¼‰æ˜¯ä¸€ä¸ªé‡è¦çš„é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ³•åˆ™æ¥å‰Šå‡è®¡ç®—æœºç¨‹åºçš„è€¦åˆé—®é¢˜.æ§åˆ¶åè½¬ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼Œç®€ç§°DIï¼‰å’Œä¾èµ–æŸ¥æ‰¾ï¼ˆDependency Lookupï¼‰ã€‚ä¾èµ–æ³¨å…¥åº”ç”¨æ¯”è¾ƒå¹¿æ³›ã€‚</p>
<h6 id="ä¸ªäººç†è§£ï¼š"><a href="#ä¸ªäººç†è§£ï¼š" class="headerlink" title="ä¸ªäººç†è§£ï¼š"></a>ä¸ªäººç†è§£ï¼š</h6><p>åœ¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªå¯¹è±¡ä¸­çš„æ–¹æ³•éœ€è¦ä¾èµ–å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­ä¿å­˜å…¶æ‰€ä¾èµ–å¯¹è±¡çš„å®ä¾‹ï¼Œç”Ÿæˆä¾èµ–å¯¹è±¡çš„æ–¹å¼ä¸å†è¯¥å¯¹è±¡ä¸­é€šè¿‡newåˆ›å»ºï¼Œè€Œæ˜¯è°ƒç”¨è€…å¤–éƒ¨åˆ›å»ºä¾èµ–å¯¹è±¡ï¼Œé€šè¿‡ä¸€å®šçš„æ–¹å¼è¿›è¡Œä¼ å…¥ã€‚</p>
<h6 id="ä¾èµ–æ³¨å…¥çš„ä¸‰ç§å®ç°æ–¹å¼ï¼ˆåŸç”Ÿæ–¹å¼ï¼‰ï¼š"><a href="#ä¾èµ–æ³¨å…¥çš„ä¸‰ç§å®ç°æ–¹å¼ï¼ˆåŸç”Ÿæ–¹å¼ï¼‰ï¼š" class="headerlink" title="ä¾èµ–æ³¨å…¥çš„ä¸‰ç§å®ç°æ–¹å¼ï¼ˆåŸç”Ÿæ–¹å¼ï¼‰ï¼š"></a>ä¾èµ–æ³¨å…¥çš„ä¸‰ç§å®ç°æ–¹å¼ï¼ˆåŸç”Ÿæ–¹å¼ï¼‰ï¼š</h6><ol>
<li>æ„é€ æ–¹æ³•æ³¨å…¥ è¯¥æ–¹å¼æ˜¯é€šè¿‡æ„é€ æ–¹æ³•å°†å…¶æ‰€ä¾èµ–çš„å¤–éƒ¨ç±»å¯¹è±¡ä¼ å…¥è¿›æ¥ï¼Œæ˜¯æˆ‘è®¤ä¸ºçš„æœ€ç®€å•çš„æ–¹å¼ã€‚å…¶å®ç°æ–¹å¼å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¹‹å‰çš„ä»£ç ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Classes &#123;</span><br><span class="line">&#x2F;&#x2F; ä¾èµ–ç±»</span><br><span class="line">private Boy boy;</span><br><span class="line">&#x2F;**</span><br><span class="line">* æ„é€ æ–¹æ³•æ³¨å…¥ï¼Œé€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥è¯¥å¯¹è±¡</span><br><span class="line">* @param boy</span><br><span class="line">*&#x2F;</span><br><span class="line">public Classes(Boy boy) &#123;</span><br><span class="line">this.boy &#x3D; boy;</span><br><span class="line">&#125;</span><br><span class="line">public void run() &#123;</span><br><span class="line">boy.run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Setter æ³¨å…¥ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> public class Classes &#123;</span><br><span class="line">&#x2F;&#x2F;....</span><br><span class="line">private Boy boy;</span><br><span class="line"></span><br><span class="line">public void setBoy(Boy boy)&#123;</span><br><span class="line">    this.boy &#x3D; boy;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æ¥å£æ–¹å¼ æ¥å£æ–¹å¼æ˜¯å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£ä¸­å£°æ˜ä¸€ä¸ªæ³¨å…¥çš„æ–¹æ³•ï¼Œè€Œéœ€è¦æ³¨å…¥çš„ç±»å®ç°è¯¥æ¥å£ï¼Œå®ç°æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚å®šä¹‰æ¥å£ï¼Œå£°æ˜æ³¨å…¥æ–¹æ³•:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public interface BoyInjection &#123;</span><br><span class="line">	void inject(Boy boy); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Classes implements BoyInjection &#123;</span><br><span class="line"> 	&#x2F;&#x2F;.... private Boy boy; </span><br><span class="line">	@Override public void inject(Boy boy) &#123; </span><br><span class="line">	&#x2F;&#x2F;å®ç°æ¥å£ä¸­çš„æ–¹æ³• this.boy &#x3D; boy; </span><br><span class="line">&#125; </span><br><span class="line">&#x2F;&#x2F;....</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h6 id="Android-Dagger2ä¾èµ–æ³¨å…¥"><a href="#Android-Dagger2ä¾èµ–æ³¨å…¥" class="headerlink" title="Android Dagger2ä¾èµ–æ³¨å…¥:"></a>Android Dagger2ä¾èµ–æ³¨å…¥:</h6><ul>
<li>å¼•å…¥ä¾èµ–åº“:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compile &#39;com.google.dagger:dagger:2.11&#39;</span><br><span class="line"> annotationProcessor &#39;com.google.dagger:dagger-compiler:2.11&#39;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç‰ˆæœ¬å·ä»¥å®˜ç½‘ä¸ºå‡†ï¼š<a target="_blank" rel="noopener" href="https://github.com/google/dagger">https://github.com/google/dagger</a> </p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªå¯¹è±¡:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class A &#123;</span><br><span class="line">    public void eat() &#123;</span><br><span class="line">        System.out.print(&quot;åƒé¥­äº†&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºMouduleï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;ç¬¬ä¸€æ­¥ æ·»åŠ @Module æ³¨è§£</span><br><span class="line">@Module</span><br><span class="line">public class MainModule &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºå…·ä½“çš„ç¤ºä¾‹:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;ç¬¬ä¸€æ­¥ æ·»åŠ @Module æ³¨è§£</span><br><span class="line">@Module</span><br><span class="line">public class MainModule &#123;</span><br><span class="line">    &#x2F;&#x2F;ç¬¬äºŒæ­¥ ä½¿ç”¨Provider æ³¨è§£ å®ä¾‹åŒ–å¯¹è±¡</span><br><span class="line">    @Provides</span><br><span class="line">    A providerA() &#123;   &#x2F;&#x2F; providerAåªæ˜¯ä¸ªåç§°</span><br><span class="line">        return new A();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºä¸€ä¸ªComponent:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;ç¬¬ä¸€æ­¥ æ·»åŠ @Component</span><br><span class="line">&#x2F;&#x2F;ç¬¬äºŒæ­¥ æ·»åŠ module</span><br><span class="line">@Component(modules &#x3D; &#123;MainModule.class&#125;)  &#x2F;&#x2F;ä¸åˆšåˆšåˆ›å»ºçš„Mouduleè¿æ¥èµ·æ¥</span><br><span class="line">public interface MainComponent &#123;</span><br><span class="line">    &#x2F;&#x2F;ç¬¬ä¸‰æ­¥  å†™ä¸€ä¸ªæ–¹æ³• ç»‘å®šActivity &#x2F;Fragment</span><br><span class="line">    void inject(MainActivity activity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¹‹åRebuild Projectä¸€ä¸‹ï¼ŒMake Projectä¹Ÿè¡Œï¼Œä¹‹åç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºå‡ ä¸ªç±»ï¼Œç”¨æ¥ä¸activityè¿æ¥ã€‚(è¿™ä¸€æ­¥æ“ä½œå¯èƒ½ä¼šè¦ç­‰å¾…å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œ10åˆ†é’Ÿå·¦å³)</p>
</blockquote>
<ul>
<li>å°†Componentä¸Activity/Fragmentç»‘å®šå…³ç³»:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    &#x2F;***</span><br><span class="line">     * ç¬¬äºŒæ­¥  ä½¿ç”¨Inject æ³¨è§£ï¼Œè·å–åˆ°A å¯¹è±¡çš„å®ä¾‹</span><br><span class="line">     *&#x2F;</span><br><span class="line">    @Inject  &#x2F;&#x2F;è®°å¾—åœ¨éœ€è¦çš„å‚æ•°å‰åŠ @Inject</span><br><span class="line">A a;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        &#x2F;***</span><br><span class="line">         * ç¬¬ä¸€æ­¥ æ·»åŠ ä¾èµ–å…³ç³»</span><br><span class="line">         *&#x2F;</span><br><span class="line">        &#x2F;&#x2F;ç¬¬ä¸€ç§æ–¹å¼ä¸Activity&#x2F;Fragmentè¿›è¡Œç»‘å®š</span><br><span class="line">        DaggerMainConponent.create().inject(this);</span><br><span class="line">        &#x2F;&#x2F;ç¬¬äºŒç§æ–¹å¼ä¸Activity&#x2F;Fragmentè¿›è¡Œç»‘å®š</span><br><span class="line">        DaggerMainConponent.builder().build().inject(this);</span><br><span class="line">        &#x2F;***</span><br><span class="line">         * ç¬¬ä¸‰æ­¥  è°ƒç”¨A å¯¹è±¡çš„æ–¹æ³•</span><br><span class="line">         *&#x2F;</span><br><span class="line">        a.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹‹åå°±å¯ä»¥äº†ï¼Œæ¥ä¸‹æ¥ä»‹ç»Dagger2çš„å•ä¾‹æ¨¡å¼.</p>
<h6 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼:"></a>å•ä¾‹æ¨¡å¼:</h6><p>@Singleton è¿™ä¸ªæ³¨é‡Šå¯ä»¥ä½¿Daggerè¿›å…¥å•ä¾‹æ¨¡å¼ï¼Œè¦åœ¨Mouduleå’ŒComponentçš„ä¸Šæ–¹æ·»åŠ ä¸Š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class ActivityModule &#123;</span><br><span class="line">    @Singleton</span><br><span class="line">    @Provides</span><br><span class="line">    Student privadeStu()&#123;</span><br><span class="line">        return new Student();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Singleton</span><br><span class="line">@Component(modules &#x3D; &#123;ActivityModule.class&#125;)</span><br><span class="line">public interface ActivityComponent &#123;</span><br><span class="line">    void inject(MainActivity mainActivity);</span><br><span class="line">    void inject(UserActivity userActivity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ @Singletonå°±å˜æˆå•ä¾‹äº†ï¼Œåœ¨MainActivityé‡Œ å£°æ˜ä¸¤ä¸ªStudentä¸åŒåå­—çš„å¯¹è±¡åˆ†åˆ«æ‰“å°ä»–çš„åœ°å€ï¼Œä½ ä¼šå‘ç°åœ°å€æ˜¯ä¸€æ ·çš„<br>ä½†æ˜¯ä½ å†æ–°å»ºç«‹ä¸€ä¸ªActivity å†æ¬¡å£°æ˜ Student stu ï¼Œæ³¨å…¥å¯¹è±¡ï¼Œä½ ä¼šå‘ç°è¿™æ—¶å€™ åœ°å€å°±ä¸ä¸€æ ·äº†ã€‚å› ä¸ºæŒæœ‰çš„å¯¹è±¡æ˜¯Activityã€‚<br>åˆ°æ­¤å·²ç»èƒ½åœ¨ä¸€ä¸ªActivityé‡Œï¼Œå£°æ˜ä¸¤ä¸ªå¯¹è±¡å˜é‡ï¼Œç”¨@Injectæ³¨å…¥ï¼Œå¾—åˆ°çš„æ˜¯ åŒä¸€ä¸ªå¯¹è±¡</p>
<h6 id="Singletonçš„åˆ†æ"><a href="#Singletonçš„åˆ†æ" class="headerlink" title="@Singletonçš„åˆ†æ:"></a>@Singletonçš„åˆ†æ:</h6><p>æ¥ä¸‹æ¥æˆ‘è¦æ¨ç¿»åˆšæ‰è¯´çš„@Singletonï¼Œçœ‹åˆ°è‹±æ–‡Singleton æ˜¯å•ä¾‹çš„æ„æ€ï¼Œåœ¨Dagger2é‡Œä»–å°±æ˜¯ä¸ªå‘½åçš„ä¸€ä¸ªæ³¨è§£è€Œå·²<br>ä»–å«ä»€ä¹ˆåå­—éƒ½è¡Œ @ABCã€@ABBã€@ABCCï¼Œéƒ½è¡Œã€‚ç‚¹å¼€Singletonï¼ˆctrl+Bï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Scope   &#x2F;&#x2F;ä½œç”¨åŸŸçš„æ³¨é‡Šï¼Œä»£è¡¨ç€è¢«åŒ…æ‹¬çš„éƒ½æ˜¯åœ¨ä¸€ä¸ªä½œç”¨åŸŸä¹‹ä¸­</span><br><span class="line">@Documented</span><br><span class="line">@Retention(RUNTIME)</span><br><span class="line">public @interface Singleton &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Singleton ç”¨äº†@Scopeï¼ˆä½œç”¨åŸŸï¼‰ æ ‡è®°ã€‚ ä¹Ÿå°±æ˜¯è¯´è¢« @ScopeåŒ…è£¹çš„Component éƒ½æ˜¯åœ¨ä¸€ä¸ªä½œç”¨åŸŸé‡Œçš„ï¼Œ ä½œç”¨åŸŸï¼ä¸å«å•ä¾‹<br>å¥½ é‚£ç›´æ¥ç”¨ScopeåŒ…è£¹Componentã€‚ç¼–è¯‘å™¨æç¤º ç›´æ¥Removeäº†è¿™ä¸ªæ³¨è§£ã€‚å› ä¸ºä»–çš„ç›®æ ‡æ˜¯ @Target(ANNOTATION_TYPE) è¿™ä¸ªè¡¨ç¤ºè¿™ä¸ªScopeåªç”¨äºæ³¨è§£ï¼Œä¸èƒ½ç”¨åœ¨ ç±»ä¸Šé¢</p>
<h6 id="é‚£æˆ‘ä»¬å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼š"><a href="#é‚£æˆ‘ä»¬å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼š" class="headerlink" title="é‚£æˆ‘ä»¬å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼š"></a>é‚£æˆ‘ä»¬å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Scope</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface ActivityScope &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠåˆšæ‰åŠ @Singletonçš„åœ°æ–¹å…¨æ¢æˆ@ActivityScope</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class ActivityModule &#123;</span><br><span class="line">    @ActivityScope</span><br><span class="line">    @Provides</span><br><span class="line">    Student privadeStu()&#123;</span><br><span class="line">        return new Student();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@ActivityScope</span><br><span class="line">@Component(modules &#x3D; &#123;ActivityModule.class&#125;)</span><br><span class="line">public interface ActivityComponent &#123;</span><br><span class="line">    void inject(MainActivity mainActivity);</span><br><span class="line">    void inject(UserActivity userActivity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å°ä¸¤ä¸ªå¯¹è±¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tag: com.mydagger.bean.Student@96575e0</span><br><span class="line">tag: com.mydagger.bean.Student@96575e0</span><br></pre></td></tr></table></figure>

<p>åˆšæ‰è¯´äº†æŒæœ‰å¯¹è±¡çš„æ˜¯Activityï¼Œé‚£åªèƒ½åœ¨ä¸€ä¸ªActivityä¸­å®ç°å•ä¾‹ï¼Œé‚£è¦å…¨å±€å•ä¾‹æ€ä¹ˆåšå‘¢ï¼Ÿ<br>é€šå¸¸è¦å…¨å±€ä½¿ç”¨çš„å¯¹è±¡ï¼Œè¦ä¹ˆå†™ä¸ªstaticçš„ç±»ï¼Œè¦ä¹ˆApplicationã€‚æˆ‘ä»¬ç›´æ¥Application</p>
<ul>
<li><p>å…¨å±€å•ä¾‹:</p>
<ol>
<li><p>å…ˆå®šä¹‰ä¸ªå…¨å±€çš„æ³¨è§£ï¼Œåˆšè®²äº†åå­—æ— æ‰€è°“(è¿™é‡Œè¦åˆ›å»ºç¬¬äºŒä¸ªçš„æ³¨è§£æ˜¯å› ä¸ºï¼Œä¸€ä¸ªæ³¨è§£åªèƒ½ä½œç”¨åˆ°ä¸€ä¸ªä½œç”¨åŸŸï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸èƒ½ä¸ç­‰ä¸‹è¦åˆ›å»ºçš„çš„å¦ä¸€ä¸ªComponentçš„æ³¨è§£ç›¸åŒ)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> @Scope  &#x2F;&#x2F;ä½œç”¨åŸŸçš„æ„æ€</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface AppScope &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@ActivityScope</span><br><span class="line">&#x2F;&#x2F;å…ˆç»‘å®šè‡ªèº«çš„Moduleï¼Œåœ¨ç»‘å®šè¦ä¾èµ–çš„Component</span><br><span class="line">@Component(modules &#x3D; &#123;ActivityModule.class&#125;,dependencies &#x3D; AppComponent.class)</span><br><span class="line">public interface ActivityComponent &#123;</span><br><span class="line">    &#x2F;&#x2F;ç¬¬ä¸€ä¸ªactivityçš„ç»‘å®šæ–¹æ³•ï¼ˆXXXActivityå°±æ˜¯å¡«å†™ä½ è‡ªå·±çš„activityçš„åå­—ï¼‰</span><br><span class="line">void inject(XXXActivity testActivity);</span><br><span class="line">&#x2F;&#x2F;ç¬¬äºŒä¸ªactivityçš„ç»‘å®šæ–¹æ³•</span><br><span class="line">    void inject(XXXActivity testActivity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¢åŠ äº†ä¸€ä¸ª dependenciesï¼ˆä¾èµ–ï¼‰ï¼Œå½“å‰æ˜¯ActivityComponent ä¾èµ– AppComponent<br>æ–°å»ºä¸€ä¸ª AppComponent, è¿æ¥ä¸€ä¸ªModuleï¼Œæä¾›ä¸€ä¸ªæ–¹æ³• æä¾› ç»™ MainActivity @Injectä½¿ç”¨<br>è¿˜æœ‰å°±æ˜¯dependenciesåªæ˜¯ä¾èµ–ä¸å¦ä¸€ä¸ªComponentï¼Œæ¯ä¸ªComponentéƒ½å¿…é¡»è¦æœ‰ä¸€ä¸ªä¸åŒçš„Modulesï¼ˆModulesä¸­çš„beanç±»ä¸èƒ½é‡å¤ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æ³¨æ„è¿™é‡Œçš„æ³¨è§£ä¸ä¸Šé¢æ³¨è§£ä¸åŒï¼ˆå°½ç®¡æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä½†ä¹Ÿä¸èƒ½ä¸€æ ·ï¼‰</span><br><span class="line">@AppScope</span><br><span class="line">@Component(modules &#x3D; &#123;AppModule.class&#125;)</span><br><span class="line">public interface AppComponent &#123;</span><br><span class="line">&#x2F;&#x2F;è¿™é‡Œè¦é‡æ–°åˆ›å»ºä¸€ä¸ªSchoolç±»(è¿™é‡Œå†™çš„æ–¹æ³•è¦ä¸Moduleä¸­çš„ç±»ä¸€è‡´ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™)</span><br><span class="line">    School getSchool();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ul>
<p>æ–°å»º AppModule, æä¾›ä¸€ä¸ªæ–¹æ³• ç”¨AppScopeå’ŒProvidesæ ‡è®°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class AppModule &#123;</span><br><span class="line">&#x2F;&#x2F;è¿™é‡Œçš„æ³¨è§£è¦ä¸Componentç›¸åŒ</span><br><span class="line">    @AppScope</span><br><span class="line">    @Provides</span><br><span class="line">    School provideSchool()&#123;   &#x2F;&#x2F;ä¹Ÿæ˜¯è¿”å›ä¸ä¸Šä¸€ä¸ªModuleä¸ä¸€æ ·çš„Beanç±»</span><br><span class="line">        return  new School();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­ç‚¹ç»¿é”¤å­ç¼–è¯‘ä¿®æ”¹Application</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªè‡ªèº«çš„å•ä¾‹ç±»</span><br><span class="line">public static Application app;</span><br><span class="line">&#x2F;&#x2F;åœ¨åˆ›å»ºä¸€ä¸ªComponentç±»</span><br><span class="line">AppComponent applicationComponent;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onCreate() &#123;</span><br><span class="line">super.onCreate();</span><br><span class="line">&#x2F;&#x2F;è·å–è‡ªèº«çš„å®ä¾‹</span><br><span class="line">app &#x3D; this;</span><br><span class="line">&#x2F;&#x2F;åœ¨onCreateä¸­è¿›è¡Œè·å–Component</span><br><span class="line">    applicationComponent &#x3D; DaggerAppComponent</span><br><span class="line">            .builder()</span><br><span class="line">	&#x2F;&#x2F;æ¯æ¬¡è°ƒç”¨ç³»ç»Ÿåˆ›å»ºçš„Componentç±»è¿›è¡Œç»‘å®šçš„æ—¶å€™éƒ½è¦ç»‘å®šå±äºè‡ªå·±çš„Moduleç±»</span><br><span class="line">            .appModule(new AppModule())</span><br><span class="line">            .build();</span><br><span class="line">	&#x2F;&#x2F;å› ä¸ºè¿™ä¸ªComponentæ˜¯ç»™ä¸Šä¸€ä¸ªComponentï¼ˆMainComponentï¼‰è¿›è¡Œä¾èµ–çš„ï¼Œä¹Ÿå°±æ˜¯æ‰©å±•ï¼Œæ‰€ä»¥æ²¡æœ‰å†™ç»‘å®šçš„æ–¹æ³•&#125;</span><br><span class="line"></span><br><span class="line">public static Application getInstance()&#123;</span><br><span class="line">&#x2F;&#x2F;è¿”å›è‡ªèº«çš„å®åˆ—</span><br><span class="line">    return app;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿”å›ä¸€ä¸ªApplicationçš„å®ä¾‹å¯¹è±¡ã€‚å®šä¸€ä¸ªAppComponentï¼ˆè¿™ä¸ªæ˜¯å‡†å¤‡ç»™DaggerActivityComponentä¾èµ–çš„ï¼‰ä¹Ÿæ˜¯Daggerç”Ÿæˆçš„ä»£ç ã€‚é“¾å¼ç¼–ç¨‹è¿›è¡Œbuild<br>å¢åŠ ä¸€ä¸ªSchoolç±» å’ŒStudentç±»ä¸€æ · ç”¨@Injectä¿®é¥°æ„é€ å‡½æ•°ã€‚<br>ä¿®æ”¹MainActivityï¼Œå¢åŠ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Inject</span><br><span class="line">School school;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨onCreateåé¢å¢åŠ ï¼ˆä¸activityå’ŒFragmemtè¿›è¡Œç»‘å®šï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DaggerActivityComponent.builder()</span><br><span class="line">&#x2F;&#x2F;ç»‘å®šä¾èµ–Componentï¼ˆé€šè¿‡Applicationè·å–æ—©å°±åˆ›å»ºå¥½çš„Componentï¼‰</span><br><span class="line">.appComponent(Application.getInstance().applicationComponent)</span><br><span class="line">&#x2F;&#x2F;ç»‘å®šè‡ªèº«çš„Module</span><br><span class="line">    .activityModule(new ActivityModule())</span><br><span class="line">.build()</span><br><span class="line">&#x2F;&#x2F;ç»‘å®šActivity</span><br><span class="line">    .inject(this);</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒè¡ŒDaggerActivityComponent ä¾èµ–äº Applicationçš„ AppComponent è¿™æ ·å°±è¿›è¡Œäº†å…³è”<br>åˆ°æ­¤ å…¨å±€å•ä¾‹ æå®šï¼Œæµ‹è¯•ä¸€ä¸‹ å†™ä¸¤ä¸ªActivity å£°æ˜ç›¸åŒçš„å¯¹è±¡å°±ä¼šå‘ç° ä¸¤ä¸ªå¯¹è±¡åœ°å€ ä¸€æ ·çš„ï¼ˆåˆ›å»ºçš„ç¬¬äºŒä¸ªactivity/Fragmentä¸­ä¹Ÿè¦è¿›è¡ŒComponentç»‘å®šï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tag: com.mydagger.bean.School@393c7e3</span><br><span class="line">tag: com.mydagger.bean.School@393c7e3</span><br></pre></td></tr></table></figure>
<ul>
<li>æ‰©å±•:<br>é€šå¸¸ä¼šé¡¹ç›®ä¸­ä½¿ç”¨MVP å¢åŠ ç½‘ç»œé…ç½®ç­‰ éœ€è¦å…¨å±€å•ä¾‹çš„å†…å®¹ï¼Œå¯ä»¥ç»§ç»­å»ºç±»ï¼ˆModuleï¼‰è¿›è¡Œæ‰©å±•,å¾—åˆ°å•ä¾‹<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@AppScope</span><br><span class="line">@Component(modules &#x3D; &#123;AppModule.class,BModule.class....&#125;)</span><br><span class="line">public interface AppComponent &#123;</span><br><span class="line">    School getSchool();</span><br><span class="line">    &#x2F;&#x2F;è¿™é‡Œéœ€è¦ç»§ç»­æä¾›æ–¹æ³•ï¼Œç»™Activity è¿›è¡Œå¯¹è±¡çš„ @Inject    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">applicationComponent &#x3D; DaggerAppComponent</span><br><span class="line">        .builder()</span><br><span class="line">        .appModule(new AppModule())......</span><br><span class="line">        .build();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>

      </section>

      <section class="article-footer">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">#Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Context/" rel="tag">#Context</a></li></ul>
      </section>

      <section class="article-navs">
        
<nav class="card-container card-article-nav">
  <div class="card-list">
    
      <div id="article-nav-newer" class="card-item">
        <article>
          
          <a class="card-link article-nav-link" href="/2020/09/22/SmartRefreshLayout%E7%9A%84%E4%BD%BF%E7%94%A8/"></a>
          <strong class="article-nav-caption">Newer</strong>
          <p class="article-nav-title">
            
              SmartRefreshLayoutçš„ä½¿ç”¨
            
          </p>
        </article>
      </div>
    
    
      <div id="article-nav-older" class="card-item">
        <article>
          
          <a class="card-link article-nav-link" href="/2020/09/21/CoordinatorLayout%E7%9A%84%E4%BD%BF%E7%94%A8/"></a>
          <strong class="article-nav-caption">Older</strong>
          <p class="article-nav-title">
            
              CoordinatorLayoutçš„ä½¿ç”¨
            
          </p>
        </article>
      </div>
    
  </div>
</nav>

      </section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
          </div>
     
    <p>&copy; 2021 <a href="/" target="_blank">Fuxinbo</a></p>

    
      <p id="hitokoto"></p>
      <script src="https://v1.hitokoto.cn/?c=a&amp;encode=js&select=%23hitokoto" defer></script>
    

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">ğŸŒ æµ…è‰²</a>
      <a href="javascript:;" id="theme-dark">ğŸŒ› æ·±è‰²</a>
      <a href="javascript:;" id="theme-auto">ğŸ¤–ï¸ è‡ªåŠ¨</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
  <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
  <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
</svg> 
  </div>

  
  


  <!-- aplayer éŸ³é¢‘ start -->
  <link rel="stylesheet" href="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.css">
  <script type="text/javascript" src="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.js"></script>
  <script type="text/javascript">
    const aplayer = document.querySelectorAll(".aplayer");
    aplayer && initaplayer(aplayer);
    function initaplayer(els) {
      let elsArr = Array.from(els);
      elsArr.forEach(el => {
        let params = {
          container: el,
          audio: { ...el.dataset },
          theme: "#b7daff",
          autoplay: false,
          loop: false,
          mutex: true,
        }
        if (el.dataset.lrc) {
          params['lrcType'] = 3
        }
        new APlayer(params);
      });
    }
  </script>
  <!-- aplayer éŸ³é¢‘ end -->
  

<!-- dplayer è§†é¢‘ start -->
<script type="text/javascript" src="https://unpkg.com/hls.js@1.0.1/dist/hls.js"></script>
<script type="text/javascript" src="https://unpkg.com/dplayer@1.25.1/dist/DPlayer.min.js"></script>
<script type="text/javascript">
  const dplayer = document.querySelectorAll(".dplayer");
  dplayer && initDPlayer(dplayer);
  function initDPlayer(els) {
    let elsArr = Array.from(els);
    elsArr.forEach(el => {
      let url = el.dataset.url;
      let cover = el.dataset.cover;
      let subtitle = el.dataset.subtitle;

      let options = {
        container: el,
        video: { url: url, pic: cover },
        theme: "#b7daff",
        autoplay: false,
        loop: false,
        mutex: true,
      }

      if (subtitle) {
        options.subtitle = {
          url: el.dataset.subtitle,
        }
      }
      new DPlayer(options);
    });
  }
</script>
<!-- dplayer è§†é¢‘ end -->


<!-- waterfall ç€‘å¸ƒæµ start -->

<script src="/lib/waterfall.min.js"></script>

<script type="text/javascript">

const waterfalls = document.querySelectorAll(".waterfall-container");

if (waterfalls && waterfalls.length > 0) {
  waterfalls.forEach((waterfall, index) => {
    let cls = "waterfall-container-" + index;
    waterfall.classList.add(cls);
    initWaterfall(cls, waterfall);
  });
}

function initWaterfall(selector, el) {
  const options = {};
  if (Object.keys(el.dataset).length > 0) {
    for (let k in el.dataset) {
      options[k] = el.dataset[k];
    }
  }
  waterfall(`.${selector}`, options);
}
</script>
<!-- waterfall ç€‘å¸ƒæµ end -->


  <!-- zoom start -->
  
<script src="/lib/zoom.min.js"></script>

  <script type="text/javascript">
    document.querySelector(".article-content") && zoom(".article-content");
  </script>
  <!-- zoom end -->
  



  


  


  




<script src="/js/script.js"></script>


  
  <!-- å°¾éƒ¨ç”¨æˆ·è‡ªå®šä¹‰ç›¸å…³å†…å®¹ -->
</body>
</html>